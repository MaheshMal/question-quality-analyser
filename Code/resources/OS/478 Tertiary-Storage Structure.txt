 would you buy a vcr that had inside it only one tape that you could not take out or replace? or a dvd or cd player that had one disk sealed inside? of course not. you expect to use a vcr or cd player with many relatively inexpensive tapes or disks. on a computer as well using many inexpensive cartridges with one drive lowers the overall cost. low cost is the defining characteristic of tertiary storage which we discuss in this section. . . tertiary storage devices because costis so important in practice tertiary storage is built with removable media. the most common examples are floppy disks tapes and read only write once and rewritable cds and dvds. many any other kinds of tertiarystorage devices are available as well including removable devices that store data in flash memory and interact with the computer system via a usb interface. . . . removable disks removable disks are one kind of tertiary storage. floppy disks are an example of removable magnetic disks. they are made from a thin flexible disk coated . tertiary storage structure with magnetic material and enclosed in a protective plastic case. although common floppy disks can hold only about mb similar technology is used for removable magnetic disks that hold more than gb. removable magnetic disks can be nearly as fast as hard disks although the recording surface is at greater risk of damage from scratches. a magneto optic disk is another kind of removable disk. it records data on a rigid platter coated with magnetic material but the recording technology is quite different from that for a magnetic disk. the magneto optic head flies much farther from the disk surface than a magnetic disk head does and the magnetic material is covered with a thick protective layer of plastic or glass. this arrangement makes the disk much more resistant to head crashes. the drive has a coil that produces a magnetic field at room temperature the field is too large and too weak to magnetize a bit on the disk. to write a bit the disk head flashes a laser beam at the disk surface. the laser is aimed at a tiny spot where a bit is to be written. the laser heats this spot which makes the spot susceptible to the magnetic field. now the large weak magnetic field can record a tiny bit. the magneto optic head is too far from the disk surface to read the data bydetecting the tiny magnetic fields in the way that the head of a hard disk does. instead the drive reads a bit using a property of laser light called the kerr effect. when a laser beam is bounced off of a magnetic spot the polarization of the laser beam is rotated clockwise or counterclockwise depending on the orientation of the magnetic field. this rotation is what the head detects to read a bit. another category of removable disk is the optical disk. optical disks do not use magnetism at all. instead they use special materials that can be altered by laser light to have relatively dark or bright spots. one example of optical disk technology is the phase change disk which is is coated with a material that can freeze into either a crystalline or an amorphous state. the crystalline state is more transparent and hence a laser beam is brighter when it passes through the material and bounces off the reflective layer. the phase change drive uses laser light at three different powers low power to read data medium power to erase the disk by melting and refreezing the recording medium into the crystalline state and high power to melt the medium into the amorphous state to write to the disk. the most common examples of this technology are the re recordable cd rw and dvd rw. the kinds of disks just described can be used over and over. they are called read write disks. in contrast write once read many times worm disks can be written only once. an old way to make a worm disk is to manufacture a thin aluminum film sandwiched between two glass or plastic platters. to write a bit the drive uses a laser light to burn a small hole through the aluminum . this burning cannot be reversed. although it is possible to destroy the information on a worm disk by burning holes everywhere it is virtually impossible to alter data on the disk because holes can only be added and the ecc code associated with each sector is likely to detect such additions. wortvl disks are considered durable and reliable because the metal layer is safely encapsulated between the protective glass or plastic platters and magnetic fields cannot damage the recording. a newer write once technology records on an organic polymer dye instead of an aluminum layer the dye absorbs laser light to form marks. this technology is used in the recordable cd r and dvd r. chapter mass storage structure read only disks such as cd rom and dvd rom come from the factory with the data prerecorded. they use technology similar to that of worm disks although the bits are pressed not burned and they are very durable. most removable disks are slower than their nonremovable counterparts. the writing process is slower as are rotation and sometimes seek time. . . . tapes magnetic tape is another type of removable medium. as a general rule a tape holds more data than an optical or magnetic disk cartridge. tape drives and . disk drives have similar transfer rates. but random access to tape is much slower than a disk seek because it requires a fast forward or rewind operation that takes tens of seconds or even minutes. although a typical tape drive is more expensive than a typical disk drive the price of a tape cartridge is lower than the price of the equivalent capacity of magnetic disks. so tape is an economical medium for purposes that do not require fast random access. tapes are commonly used to hold backup copies of disk data. they are also used in large supercomputer centers to hold the enormous volumes of data used in scientific research and by large commercial enterprises. large tape installations typically use robotic tape changers that move tapes between tape drives and storage slots in a tape library. these mechanisms give the computer automated access to many tape cartridges. a robotic tape library can lower the overall cost of data storage. a diskresident file that will not be neecied for a while can be archived to tape where the cost per gigabyte is lower if the file is needed in the future the computer can stage it back into disk storage for active use. a robotic tape library is sometimes called near line storage since it is between the high performance of on line magnetic disks and the low cost of off line tapes sitting on shelves in a storage room. . . . future technology in the future other storage technologies may become important. one promising storage technology holographic storage uses laser light to record holographic photographs on special media. we can think of a hologram as a three dimensional array of pixels. each pixel represents one bit for black or for white. and all the pixels in a hologram are transferred in one flash of laser light so the data transfer rate is extremely high. with continued development holographic storage may become commercially viable. another storage technology under active research is based on microelectronic mechanical systems mems . the idea is to apply the fabrication technologies that produce electronic chips to the manufacture of small datastorage machines. one proposal calls for the fabrication of an array of tiny disk heads with a square centimeter of magnetic storage material suspended above the array. when the storage material is moved lengthwise over the heads each head accesses its own linear track of data on the material. the storage material can be shifted sideways slightly to enable all the heads to access their next track. although it remains to be seen whether this technology can be successful it may provide a nonvolatile data storage technology that is faster than magnetic disk and cheaper than semiconductor dram. . tertiary storage structure whether the storage medium is a removable magnetic disk a dvd or a magnetic tape the operating system needs to provide several capabilities to use removable media for data storage. these capabilities are discussed in section . . . . . operating system support two major jobs of an operating system are to manage physical devices and to present a virtual machine abstraction to applications. in this chapter we have seen that for hard disks the operating system provides two abstractions. one is the raw device which is just an array of data blocks. the other is a file system. for a file system on a magnetic disk the operating system queues and schedules the interleaved requests from several applications. now we shall see how the operating system does its job when the storage media are removable. . . . application interface most operating systems can handle removable disks almost exactly as they do fixed disks. when a blank cartridge is inserted into the drive or mounted the cartridge must be formatted and then an empty file system is generated on the disk. this file system is used just like a file system on a hard disk. tapes are often handled differently. the operating system usually presents a tape as a raw storage medium. an application does not open a file on the tape it opens the whole tape drive as a raw device. usually the tape drive then is reserved for the exclusive use of that application until the application exits or closes the tape device. this exclusivity makes sense because random access on a tape can take tens of seconds or even a few minutes so interleaving random accesses to tapes from more than one application would be likely to cause thrashing. when the tape drive is presented as a raw device the operating system does not provide file system services. the application must decide how to use the array of blocks. for instance a program that backs up a hard disk to tape might store a list of file names and sizes at the beginning of the tape and then copy the data of the files to the tape in that order. it is easy to see the problems that can arise from this wray of using tape. since every application makes up its own. rules for how to organize a tape a tape full of data can generally be used by only the program that created it. for instance even if we know that a backup tape contains a list of file names and file sizes followed by the file data in that order we still would find it difficult to use the tape. how exactly are the file names stored? are the file sizes in binary or in ascii? are the files written one per block or are they all concatenated together in one tremendously long string of bytes? we do not even knowr the block size on the tape because this variable is generally one that can be chosen separately for each block written. for a disk drive the basic operations are r e a d o w r i t e o and seek . tape drives have a different set of basic operations. instead of seekq a tape drive uses the locate operation. the tape locate operation is more precise than the disk seek operation because it positions the tape to a specific logical block rather than an entire track. locating to block is the same as rewinding the tape. chapter mass storage structure for most kinds of tape drives it is possible to locate to any block that has been written on a tape. in a partly filled tape however it is not possible to locate into the empty space beyond the written area because most tape drives do not manage their physical space in the same way disk drives do. for a disk drive the sectors have a fixed size and the formatting process must be used to place empty sectors in their final positions before any data can be written. most tape drives have a variable block size and the size of each block is determined on the fly when that block is written. if an area of defective tape is encountered during writing the bad area is skipped and the block is written again. this operation explains why it is not possible to locate into the empty space beyond the written area the positions and numbers of the logical blocks have not yet been determined. most tape drives have a read position operation that returns the logical block number where the tape head is. many tape drives also support a space operation for relative motion. so for example the operation space would locate backward over two logical blocks. for most kinds of tape drives writing a block has the side effect of logically erasing everything beyond the position of the write. in practice this side effect means that most tape drives are append only devices because updating a block in the middle of the tape also effectively erases everything beyond that block. the tape drive implements this appending by placing an end of tape eot mark after a block that is written. the drive refuses to locate past the eot mark but it is possible to locate to the eot and then start writing. doing so overwrites the old eot mark and places a new one at the end of the new blocks just written. in principle a file system can be implemented on a tape. but many of the file system data structures and algorithms would be different from those used for disks because of the append only property of tape. . . . file naming another question that the operating system needs to handle is how to name files on removable media. for a fixed disk naming is not difficult. on a pc the file name consists of a drive letter followed by a path name. in unix the file name does not contain a drive letter but the mount table enables the operating system to discover on what drive the file is located. if the disk is removable however knowing what drive contained the cartridge at some time in the past does not mean knowing how to find the file. if every removable cartridge in the world had a different serial number the name of a file on a removable device could be prefixed with the serial number but to ensure that no two serial numbers are the same would require each one to be about digits in length. who could remember the names of her files if she had to memorize a digit serial number for each one? the problem becomes even more difficult when we want to write data on a removable cartridge on one computer and then use the cartridge in another computer. if both machines are of the same type and have the same kind of removable drive the only difficulty is knowing the contents and data layout on the cartridge. but if the machines or drives are different many additional problems can arise. even if the drives are compatible different . tertiary storage structure computers may store bytes in different orders and may use different encodings for binary numbers and even for letters such as ascii on pcs versus ebcdic on mainframes . today's operating systems generally leave the name space problem unsolved for removable media and depend on applications and users to figure out how to access and interpret the data. fortunately a few kinds of removable .media are so well standardized that all computers use them the same way. one example is the cd. music cds use a universal format that is understood by any cd drive. data cds are available in only a few different formats so it is usual for a cd drive and the operating system device driver to be programmed to handle all the common formats. dvd formats are also well standardized. . . . hierarchical storage management a robotic jukebox enables the computer to change the removable cartridge in a tape or disk drive without human assistance. two major uses of this technology are for backups and hierarchical storage systems. the use of a jukebox for backups is simple when one cartridge becomes full the computer instructs the jukebox to switch to the next cartridge. some jukeboxes hold tens of drives and thousands of cartridges with robotic arms managing the movement of tapes to the drives. a hierarchical storage system extends the storage hierarchy beyond primary memory and secondary storage that is magnetic disk to incorporate tertiary storage. tertiary storage is usually implemented as a jukebox of tapes or removable disks. this level of the storage hierarchy is larger cheaper and slower. although the virtual memory system can be extended in a straightforward manner to tertiary storage this extension is rarely carried out in practice. the reason is that a retrieval from a jukebox can take tens of seconds or even minutes and such a long delay is intolerable for demand paging and for other forms of virtual memory use. the usual way to incorporate tertiary storage is to extend the file system. small and frequently used files remain on magnetic disk while large and old files that are not actively used are archived to the jukebox. in some file archiving systems the directory entry for the file continues to exist but the contents of the file no longer occupy space in secondary storage. if an application tries to open the file the openc system call is suspended until the file contents can be staged in from tertiary storage. when the contents are again available from magnetic disk the open operation returns control to the application which proceeds to use the disk resident copy of the data. today hierarchical storage management hsm is usually found in installations that have large volumes of data that are used seldom sporadically or periodically. current work in hsm includes extending it to provide full information life cycle management ilm . here data move from disk to tape and back to disk as needed but are deleted on a schedule or according to policy. for example some sites save e mail for seven years but want to be sure that at the end oi seven years it is destroyed. at that point the data could be on disk hsm tape and backup tape. ilm centralizes knowledge of where the data are so that policies can be applied across all these locations. chapter mass storage structure . . performance issues as with any component of the operating system the three most important aspects of tertiary storage performance are speed reliability and cost. . . . speed the speed of tertiary storage has two aspects bandwidth and latency. we measure the bandwidth in bytes per second. the sustained bandwidth is the average data rate during a large transfer that is the number of bytes divided by the transfer time. the effective bandwidth calculates the average over the entire i o time including the time for seekq or locate and any cartridgeswitching time in a jukebox. in essence the sustained bandwidth is the data rate when the data stream is actually flowing and the effective bandwidth is the overall data rate provided by the drive. the bandwidth ofa drive is generally understood to mean the sustained bandwidth. for removable disks the bandwidth ranges from a few megabytes per second for the slowest to over mb per second for the fastest. tapes have a similar range of bandwidths from a few megabytes per second to over mb per second. the second aspect of speed is the access latency. by this performance measure disks are much faster than tapes disk storage is essentially twodimensional all the bits are out in the open. a disk access simply moves the arm to the selected cylinder and waits for the rotational latency which may take less than milliseconds. by contrast tape storage is three dimensional. at any time a small portion of the tape is accessible to the head whereas most of the bits are buried below hundreds or thousands of layers of tape wound on the reel. a random access on tape requires winding the tape reels until the selected block reaches the tape head which can take tens or hundreds of seconds. so we can generally say that random access within a tape cartridge is more than a thousand times slower than random access on disk. if a jukebox is involved the access latency can be significantly higher. for a removable disk to be changed the drive must stop spinning then the robotic arm must switch the disk cartridges and then the drive must spin up the new cartridge. this operation takes several seconds about a hundred times longer than the random access time within one disk. so switching disks in a jukebox incurs a relatively high performance penalty. for tapes the robotic arm time is about the same as for disk. but for tapes to be switched the old tape generally must rewind before it can be ejected and that operation can take as long as minutes. and after a new tape is loaded into the drive many seconds can be required for the drive to calibrate itself to the tape and to prepare for i o. although a slow tape jukebox can have a tape switch time of or minutes this time is not enormously greater than the random access time within one tape. so to generalize we say that random access in a disk jukebox has a latency of tens of seconds whereas random access in a tape jukebox has a latency of hundreds of seconds switching tapes is expensive but switching disks is not. be careful not to overgeneralize though some expensive tape jukeboxes can rewind eject load a new tape and fast forward to a random item of data all in less than seconds. . tertiary storage structure if we pay attention to only the performance of the drives in a jukebox the bandwidth and latency seem reasonable. but if we focus our attention on the cartridges instead we find a terrible bottleneck. consider first the bandwidth. the bandwidth to storage capacity ratio of a robotic library is much less favorable than that of a fixed disk. to read all the data stored on a large hard disk could take about an hour. to read all the data stored in a large tape library could take years. the situation with respect to access latency is nearly as bad. to illustrate this if requests are queued for a disk drive the average waiting time will be about a second. if requests are queued for a tape library the average waiting time could be over an hour. the lowcost of tertiary storage results from having many cheap cartridges share a few expensive drives. but a removable library is best devoted to the storage of infrequently used data because the library can satisfy only a relatively small number of i o requests per hour. . . . reliability although we often think good performance means high speed another important aspect of performance is reliability. if we try to read some data and are unable to do so because of a drive or media failure for all practical purposes the access time is infinitely long and the bandwidth is infinitely small. so it is important to understand the reliability of removable media. removable magnetic disks are somewhat less reliable than are fixed hard disks because the cartridge is more likely to be exposed to harmful environmental conditions such as dust large changes in temperature and humidity and mechanical forces such as shock and bending. optical disks are considered very reliable because the layer that stores the bits is protected by a transparent plastic or glass layer. the reliability of magnetic tape varies widely depending on the kind of drive. some inexpensive drives wear out tapes after a few dozen uses other kinds are gentle enough to allow millions of reuses. by comparison with a magnetic disk head the head in a magnetic tape drive is a weak spot. a disk head flies above the media but a tape head is in close contact with the tape. the scrubbing action of the tape can wear out the head after a few thousands or tens of thousands of hours. in summary we say that a fixed disk drive is likely to be more reliable than a removable disk or tape drive and an optical disk is likely to be more reliable than a magnetic disk or tape. but a fixed magnetic disk has one weakness. a head crash in a hard disk generally destroys the data whereas the failure of a tape drive or optical disk drive often leaves the data cartridge unharmed. . . . cost storage cost is another important factor. here is a concrete example of how removable media may lower the overall storage cost. suppose that a hard disk that holds x gb has a price of of this amount is for the housing motor and controller and is for the magnetic platters. the storage cost for this disk is x per gigabyte. now suppose that we can manufacture the platters in a removable cartridge. for one drive and cartridges the total price is and the capacity is x gb so the storage cost is x per gigabyte. even if it is a little more expensive to make a removable cartridge chapter mass storage structure mb s s year figure . price per megabyte of dram from to . the cost per gigabyte of removable storage may well be lower than the cost per gigabyte of a hard disk because the expense of one drive is averaged with the low price of many removable cartridges. figures . . and . show the cost trends per megabyte for dram memory magnetic hard disks and tape drives. the prices in the graphs are the lowest prices found in advertisements in various computer magazines and on the world wide web at the end of each year. these prices reflect the smallcomputer marketplace of the readership of these magazines where prices are low by comparison with the mainframe and minicomputer markets. in the case of tape the price is for a drive with one tape. the overall cost of tape storage becomes much lower as more tapes are purchased for use with the drive because the price of a tape is a small fraction of the price of the drive. however in a huge tape library containing thousands of cartridges the storage year figure . price per megabyte of magnetic hard disk from to . . tertiary storage structure . gb year figure . price per megabyte of a tape drive from to . cost is dominated by the cost of the tape cartridges. as of this writing in the cost per gb of tape cartridges can be approximated as somewhat less than . the cost of dram fluctuates widely. in the period from to we can see three price crashes around and as excess production caused a glut in the marketplace. we can also see two periods around and where shortages in the marketplace caused significant price increases. in the case of hard disks the price decline has been much steadier although it appears to have accelerated since . tape drive prices also fell steadily up to . since the price per gigabyte of inexpensive tape drives has ceased its dramatic fall although the price of mid range tape technology such as dat dds has continued to fall and is now approaching that of the inexpensive drives. tape drive prices are not shown prior to because as mentioned the magazines used in tracking prices are targeted to the small computer marketplace and tape drives were not widely used with small computers prior to . we can see from these graphs that the cost of storage has fallen dramatically over the past twenty years or so. by comparing the graphs we can also see that the price of disk storage has plummeted relative to the price of dram and tape. the price per megabyte of magnetic disk has improved by more than four orders of magnitude during the past two decades whereas the corresponding improvement for main memory has been only three orders of magnitude. main memory today is more expensive than disk storage by a factor of . the price per megabyte has dropped much more rapidly for disk drives than for tape drives as well. in fact the price per megabyte of a magnetic disk drive is approaching that of a tape cartridge without the tape drive. consequently small and medium sized tape libraries have a higher storage cost than disk systems with equivalent capacity. the dramatic fall in disk prices has largely rendered tertiary storage obsolete we no longer have any tertiary storage technology that is orders of magnitude less expensive than magnetic disk. it appears that the revival chapter mass storage structure of tertiary storage must await a revolutionary technology breakthrough. meanwhile tape storage will find its use mostly limited to purposes such as backups of disk drives and archival storage in enormous tape libraries that greatly exceed the practical storage capacity of large disk farms