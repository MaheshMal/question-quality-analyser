 windows xp supports both peer to peer and client server networking. it also has facilities for network management. the networking components in windows xp provide data transport interprocess communication file sharing across a network and the ability to send print jobs to remote printers. . . network interfaces to describe networking in windows xp we must first mention two of the internal networking interfaces the network device interface specification ndis and the transport driver interface tdi . the ndis interface was developed in by microsoft and com to separate network adapters from transport protocols so that either could be changed without affecting the other. ndis resides at the interface between the data link control and media accesscontrol layers in the osi model and enables many protocols to operate over many different network adapters. in terms of the osi model the tdi is the interface between the transport layer layer and the session layer layer . this interface enables any session layer component to use any available transport mechanism. similar reasoning led to the streams mechanism in unix. the tdi supports both connection based and connectionless transport and has functions to send any type of data. . . protocols windows xp implements transport protocols as drivers. these drivers can be loaded and unloaded from the system dynamically although in practice the system typically has to be rebooted after a change. windows xp comes with several networking protocols. next we discuss a number of the protocols supported in windows xp to provide a variety of network functionality. . . . server message block the server message block smb protocol was first introduced in ms dos . . the system uses the protocol to send i o requests over the network. the smb protocol has four message types. the session control messages are commands that start and end a redirector connection to a shared resource at the server. a redirector uses f i l e messages to access files at the server. the system . networking uses p r i n t e r messages to send data to a remote print queue and to receive back status information and the message message is used to communicate with another workstation. the smb protocol was published as the common internet file system cif and is supported on a number of operating systems. . . . network basic input output system the network basic input output system netbios is a hardware abstraction interface for networks analogous to the bios hardware abstraction interface devised for pcs running ms dos. netbios developed in the early s has become a standard network programming interface. netbios is used to establish logical names on the network to establish logical connections or sessions between two logical names on the network and to support reliable data transfer for a session via either netbios or smb requests. . . . netbios extended user interface the netbiosextended user interface netbeui was introduced by ibm in as a simple efficient networking protocol for up to machines. it is the default protocol for windows peer networking and for windows for workgroups. windows xp uses netbeui when it wants to share resources with these networks among the limitations of netbeui are that it uses the actual name of a computer as the address and that it does not support routing. . . . transmission control protocol internet protocol the transmission control protocol internet protocol tcp ip suite that is used on the internet has become the de facto standard networking infrastructure. windows xp uses tcp ip to connect to a wide variety of operating systems and hardware platforms. the windows xp tcp ip package includes the simple network management protocol snm dynamic host configuration protocol dhcp windows internet name service wins and netbios support. . . . point to point tunneling protocol the point to point tunneling protocol pptp is a protocol provided by windows xp to communicate between remote access server modules running on windows xp server machines and other client systems that are connected over the internet. the remote access servers can encrypt data sent over the connection and they support multi protocol virtual private networks vpns over the internet. . . . novell netware protocols the novell netware protocols ipx datagram service on the spx transport layer are widely used for pc lans. the windows xp nwlink protocol connects the netbios to netware networks. in combination with a redirector such as microsoft's client service for netware or novell's netware client for windows this protocol enables a windows xp client to connect to a netware server. chapter windows xp . . . web distributed authoring and versioning protocol web distributed authoring and versioning vvebdav is an http based protocol for collaborative authoring across the network. windows xp builds a webdav redirector into the file system. by building webdav support directly into the file system it can work with other features such as encryption. personal files can now be stored securely in a public place. . . . appletalk protocol the appletalk protocol was designed as a low cost connection by apple to allow macintosh computers to share files. windows xp systems can share files and printers with macintosh computers via appletalk if a windows xp server on the network is running the windows services for macintosh package. . . distributed processing mechanisms although windows xp is not a distributed operating system it does support distributed applications. mechanisms that support distributed processing on windows xp include netbios named pipes and mailslots windows sockets rpcs the microsoft interface definition language and finally com. . . . netbios in windows xp netbios applications can communicate over the network using netbeui nwlink or tcp ip. . . . named pipes named pipes are a connection oriented messaging mechanism. named pipes were originally developed as a high level interface to netbios connections over the network. a process can also use named pipes to communicate with other processes on the same machine. since named pipes are accessed through the file system interface the security mechanisms used for file objects also apply to named pipes. the name of a named pipe has a format called the uniform naming convention unc . a unc name looks like a typical remote file name. the format of a unc name is serverjiame sharejna me x y z where the server name identifies a server on the network a sharejname identifies any resource that is made available to network users such as directories files named pipes and printers and the x y z part is a normal file path name. . . . mailslots mailslots are a connectionless messaging mechanism. they are unreliable when accessed across the network in that a message sent to a mailslot may be lost before the intended recipient receives it. mailslots are used for broadcast applications such as finding components on the network they are also used by the windows computer browser service. . networking . . . winsock winsock is the windows xp sockets api. winsock is a session layer interface that is largely compatible with unix sockets but has some added windows xp extensions. it provides a standardized interface to many transport protocols that may have different addressing schemes so that any winsock application can run on any winsock compliant protocol stack. . . . remote procedure calls a remote procedure call rpc is a client server mechanism that enables an application on one machine to make a procedure call to code on another machine. the client calls a local procedure a stub routine that packs its arguments into a message and sends them across the network to a particular server process. the client side stub routine then blocks. meanwhile the server unpacks the message calls the procedure packs the return results into a message and sends them back to the client stub. the client stub unblocks receives the message unpacks the results of the rpc and returns them to the caller. this packing of arguments is sometimes called marshalling. the windows xp rpc mechanism follows the widely used distributed computingenvironment standard for rpc messages so programs written to use windows xp rpcs are highly portable. the rpc standard is detailed. it hides many of the architectural differences among computers such as the sizes of binary numbers and the order of bytes and bits in computer words by specifying standard data formats for rpc messages. windows xp can send rpc messages using netbios or winsock on tcp ip networks or named pipes on lan manager networks. the lpc facility discussed earlier is similar to rpc except that in the case of lpc the messages are passed between two processes running on the same computer. . . . microsoft interface definition language it is tedious and error prone to write the code to marshal and transmit arguments in the standard format to unmarshal and execute the remote procedure to marshal and send the return results and to unmarshal and return them to the caller. fortunately however much of this code can be generated automatically from a simple description of the arguments and return results. windows xp provides the microsoft interface definition language to describe the remote procedure names arguments and results. the compiler for this language generates header files that declare the stubs for the remote procedures as well as the data types for the argument and return value messages. it also generates source code for the stub routines used at the client side and for an unmarshaller and dispatcher at the server side. when the application is linked the stub routines are included. when the application executes the rpc stub the generated code handles the rest. . . . component object model the component object model com is a mechanism for interprocess communication that was developed for windows. com objects provide a well defined interface to manipulate the data in the object. for instance com is the infrastructure used by microsoft's object linking and embedding ole technology chapter windows xp for inserting spreadsheets into microsoft word documents. windows xp has a distributed extension called dcom that can be used over a network utilizing rfc to provide a transparent method of developing distributed applications. . . redirectors and servers in windows xp an application can use the windows xp i o api to access files from a remote computer as though they were local provided that the remote computer is running a cifs server such as is provided by windows xp or earlier windows systems. a redirector is the client side object that forwards i o requests to remote files where they are satisfied by a server. for performance and security the redirectors and servers run in kernel mode. in more detail access to a remote file occurs as follows . the application calls the i o manager to request that a file be opened with a file name in the standard unc format. . the i o manager builds an i o request packet as described in section . . . . . the i o manager recognizes that the access is for a remote file and calls a driver called a multiple universal naming convention provider mup . . the mup sends the i o request packet asynchronously to all registered redirectors. . a redirector that can satisfy the request responds to the mup. to avoid asking all the redirectors the same question in the future the mup uses a cache to remember which redirector can handle this file. . the redirector sends the network request to the remote system. . the remote system network drivers receive the request and pass it to the server driver. . the server driver hands the request to the proper local file system driver. . the proper device driver is called to access the data. . the results are returned to the server driver which sends the data back to the requesting redirector. the redirector then returns the data to the calling application via the i o manager. a similar process occurs for applications that use the win api network api rather than the unc services except that a module called a multi provider router is used instead of a mup. for portability redirectors and servers use the tdi api for network transport. the requests themselves are expressed in a higher level protocol which by default is the smb protocol mentioned in section . . . the list of redirectors is maintained in the system registry database. . . . distributed file system the unc names are not always convenient because multiple file servers may be available to serve the same content and unc names explicitly include the . networking name of the server. windows xp supports a distributed file systenf dfs protocol that allows a network administrator to serve up files from multiple servers using a single distributed name space. . . . folder redirection and client side caching to improve the pc experience for business users who frequently switch among computers windows xp allows administrators to give users roaming profiles which keep users preferences and other settings on servers. folder redirection is then used to automatically store a user's documents and other files on a server. this works well until one of the computers is no longer attached to the network such as a laptop on an airplane. to give users off line access to their redirected files windows xp uses client side caching csc . csc is used when the computer is online to keep copies of the server files on the local machine for better performance. the files are pushed up to the server as they are changed. if the computer becomes disconnected the files are still available and the update of the server is deferred until the next time the computer is online with a suitably performing network link. . . domains many networked environments have natural groups of users such as students in a computer laboratory at school or employees in one department in a business. frequently we want all the members of the group to be able to access shared resources on their various computers in the group. to manage the global access rights within such groups windows xp uses the concept of a domain. previously these domains had no relationship whatsoever to the domain name system dns that maps internet host names to ip addresses. now however they are closely related. specifically a windows xp domain is a group of windows xp workstations and servers that share a common security policy and user database. since windows xp now uses the kerberos protocol for trust and authentication a windows xp domain is the same thing as a kerberos realm. previous versions of nt used the idea of primary and backup domain controllers now all servers in a domain are domain controllers. in addition previous versions required the setup of one way trusts between domains. windows xp uses a hierarchical approach based on dns and allows transitive trusts that can flow up and down the hierarchy. this approach reduces the number of trusts required for n domains from n n to o . the workstations in the domain trust the domain controller to give correct information about the access rights of each user via the user's access token . all users retain the ability to restrict access to their own workstations no matter what any domain controller may say. . . . domain trees and forests because a business may have many departments and a school may have many classes it is often necessary to manage multiple domains within a single organization. a domain tree is a contiguous dns naming hierarchy for managing multiple domains. for example bell labs.com might be the root of the tree with research.bell labs.com and pez.bell labs.com as children domains research and pez. a forest is a set of noncontiguous names. an example would chapter windows xp be the trees bell lahs.com and or lucent.com. a forest may be made up of onlyone domain tree however. . . . trust relationships trust relationships may be set up between domains in three ways one way transitive and cross link. versions of nt through . allowed only one way trusts. a one way trust is exactly what its name implies domain a is told it can trust domain b. however b will not trust a tinless another relationship is configured. under a transitive trust if a trusts b and b trusts c then a b and c all trust one another since transitive trusts are two way by default. transitive trusts are enabled by default for new domains in a tree and can be configured only among domains within a forest. the third type a cross link trust is useful to cut down on authentication traffic. suppose that domains a and b are leaf nodes and that users in a often use resources in b. if a standard transitive trust is used authentication requests must traverse up to the common ancestor of the two leaf nodes but if a and b have a cross linking trust established the authentications are sent directly to the other node. . . active directory active directory is the windows xp implementation of lightweight directoryaccess protocol ldap services. active directory stores the topology information about the domain keeps the domain based user and group accounts and passwords and provides a domain based store for technologies like group policies and intellimirror. administrators use group policies to establish standards for desktop preferences and software. for many corporate information technology groups uniformity drastically reduces the cost of computing. intellimirror is used in conjunction with group policies to specify what software should be available to each class of user even automatically installing it on demand from a corporate server. . . name resolution in tcp ip networks on an ip network name resolution is the process of converting a computer name to an ip address such as resolving zuivzv.bell iabs.com to . . . . windows xp provides several methods of name resolution including windows internet name service wins broadcast name resolution domain name system dns a hosts file and an lmhosts file. most of these methods are used by many operating systems so we describe only wins here. under wins two or more wins servers maintain a dynamic database of name to ip address bindings along with client software to query the servers. at least two servers are used so that the wins service can survive a server failure and so that the name resolution workload can be spread over multiple machines. wins uses the dynamic host configuration protocol dhcp . dhcp updates address configurations automatically in the wins database without user or administrator intervention as follows. when a dhcp client starts up it broadcasts a discover message. each dhcp server that receives the message replies with an offer message that contains an ip address and configuration