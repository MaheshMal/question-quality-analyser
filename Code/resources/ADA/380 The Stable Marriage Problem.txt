in this section we consider an interesting version of bipartite matching called the stable marriage problem. consider a set y m m . . . mn of n men and a set x w w . . . wn of n women. each man has a preference list ordering the women as potential marriage partners with no ties allowed. similarly each woman has a preference list of the men also with no ties. examples of these two sets of lists are given in figures . a and . b. the same information can also be presented by an n n ranking matrix see figure . c . the rows and columns of the matrix represent the men and women of the two sets respectively. a cell in row m and column w contains two rankings the first is the position ranking of w in the m's preference list the second is the position ranking of m in the w's preference list. for example the pair in jim's row and ann's column in the matrix in figure . c indicates that ann is jim's third choice while jim is ann's first. which of these two ways to represent such information is better depends on the task at hand. for example it is easier to specify a match of the sets' elements by using the ranking matrix whereas the preference lists might be a more efficient data structure for implementing a matching algorithm. a marriage matching m is a set of n m w pairs whose members are selected from disjoint n element sets y and x in a one one fashion i.e. each man m from y is paired with exactly one woman w from x and vice versa. if we represent y and x as vertices of a complete bipartite graph with edges connecting possible marriage partners then a marriage matching is a perfect matching in such a graph. men's preferences women's preferences ranking matrix st nd rd st nd rd ann lea sue bob lea ann sue ann jim tom bob bob jim lea sue ann lea tom bob jim jim tom sue lea ann sue jim tom bob tom a b c figure . data for an instance of the stable marriage problem. a men's preference lists b women's preference lists. c ranking matrix with the boxed cells composing an unstable matching . a pair m w where m y w x is said to be a blocking pair for a marriage matching m if man m and woman w are not matched in m but they prefer each other to their mates in m. for example bob lea is a blocking pair for the marriage matching m bob ann jim lea tom sue figure . c because they are not matched in m while bob prefers lea to ann and lea prefers bob to jim. a marriage matching m is called stable if there is no blocking pair for it otherwise m is called unstable. according to this definition the marriage matching in figure . c is unstable because bob and lea can drop their designated mates to join in a union they both prefer. the stable marriage problem is to find a stable marriage matching for men's and women's given preferences. surprisingly this problem always has a solution. can you find it for the instance in figure . ? it can be found by the following algorithm. stable marriage algorithm input a set of n men and a set of n women along with rankings of the women by each man and rankings of the men by each woman with no ties allowed in the rankings output a stable marriage matching step start with all the men and women being free. step while there are free men arbitrarily select one of them and do the following proposal the selected free man m proposes to w the next woman on his preference list who is the highest ranked woman who has not rejected him before . response if w is free she accepts the proposal to be matched with m. if she is not free she compares m with her current mate. if she prefers m to him she accepts m's proposal making her former mate free otherwise she simply rejects m's proposal leaving m free. step return the set of n matched pairs. before we analyze this algorithm it is useful to trace it on some input. such an example is presented in figure . . let us discuss properties of the stable marriage algorithm. theorem the stable marriage algorithm terminates after no more than n iterations with a stable marriage output. proof the algorithm starts with n men having the total of n women on their ranking lists. on each iteration one man makes a proposal to a woman. this reduces the total number of women to whom the men can still propose in the future because no man proposes to the same woman more than once. hence the algorithm must stop after no more than n iterations. ann lea sue free men bob bob proposed to lea bob jim tom jim lea accepted tom ann lea sue free men bob jim proposed to lea jim tom jim lea rejected tom ann lea sue free men bob jim proposed to sue jim tom jim sue accepted tom ann lea sue free men bob tom proposed to sue tom jim sue rejected tom ann lea sue free men bob tom proposed to lea tom jim lea replaced bob with tom tom ann lea sue free men bob bob proposed to ann bob jim ann accepted tom figure . application of the stable marriage algorithm. an accepted proposal is indicated by a boxed cell a rejected proposal is shown by an underlined cell. let us now prove that the final matching m is a stable marriage matching. since the algorithm stops after all the n men are one one matched to the n women the only thing that needs to be proved is the stability of m. suppose on the contrary that m is unstable. then there exists a blocking pair of a man m and a woman w who are unmatched in m and such that both m and w prefer each other to the persons they are matched with in m. since m proposes to every woman on his ranking list in decreasing order of preference and w precedes m's match in m m must have proposed to w on some iteration. whether w refused m's proposal or accepted it but replaced him on a subsequent iteration with a higher ranked match w's mate in m must be higher on w's preference list than m because the rankings of the men matched to a given woman may only improve on each iteration of the algorithm. this contradicts the assumption that w prefers m to her final match in m. the stable marriage algorithm has a notable shortcoming. it is not gender neutral. in the form presented above it favors men's preferences over women's preferences. we can easily see this by tracing the algorithm on the following instance of the problem woman woman man man the algorithm obviously yields the stable matching m man woman man woman . in this matching both men are matched to their first choices which is not the case for the women. one can prove that the algorithm always yields a stable matching that is man optimal it assigns to each man the highest ranked woman possible under any stable marriage. of course this gender bias can be reversed but not eliminated by reversing the roles played by men and women in the algorithm i.e. by making women propose and men accept or reject their proposals. there is another important corollary to the fact that the stable marriage algorithm always yields a gender optimal stable matching. it is easy to prove that a man woman optimal matching is unique for a given set of participant preferences. therefore the algorithm's output does not depend on the order in which the free men women make their proposals. consequently we can use any data structure we might prefer e.g. a queue or a stack for representing this set with no impact on the algorithm's outcome. the notion of the stable matching as well as the algorithm discussed above was introduced by d. gale and l. s. shapley in the paper titled college admissions and the stability of marriage gal . i do not know which of the two applications mentioned in the title you would consider more important. the point is that stability is a matching property that can be desirable in a variety of applications. for example it has been used for many years in the united states for matching medical school graduates with hospitals for residency training. for a brief history of this application and an in depth discussion of the stable marriage problem and its extensions see the monograph by gusfield and irwing gus . exercises . . consider an instance of the stable marriage problem given by the following ranking matrix a b c for each of its marriage matchings indicate whether it is stable or not. for the unstable matchings specify a blocking pair. for the stable matchings indicate whether they are man optimal woman optimal or neither. assume that the greek and roman letters denote the men and women respectively. . design a simple algorithm for checking whether a given marriage matching is stable and determine its time efficiency class. . find a stable marriage matching for the instance given in problem by applying the stable marriage algorithm a. in its men proposing version. b. in its women proposing version. . find a stable marriage matching for the instance defined by the following ranking matrix a b c d . determine the time efficiency class of the stable marriage algorithm a. in the worst case. b. in the best case. . prove that a man optimal stable marriage set is always unique. is it also true for a woman optimal stable marriage matching? . prove that in the man optimal stable matching each woman has the worst partner that she can have in any stable marriage matching. . implement the stable marriage algorithm given in section . so that its running time is in o n . run an experiment to ascertain its average case efficiency. . write a report on the college admission problem residents hospitals assignment that generalizes the stable marriage problem in that a college can accept proposals from more than one applicant. . consider the problem of the roommates which is related to but more difficult than the stable marriage problem an even number of boys wish to divide up into pairs of roommates. a set of pairings is called stable if under it there are no two boys who are not roommates and who prefer each other to their actual roommates. gal give an instance of this problem that does not have a stable pairing. summary the iterative improvement technique involves finding a solution to an optimization problem by generating a sequence of feasible solutions with improving values of the problem's objective function. each subsequent solution in such a sequence typically involves a small localized change in the previous feasible solution. when no such change improves the value of the objective function the algorithm returns the last feasible solution as optimal and stops. important problems that can be solved exactly by iterative improvement algorithms include linear programming maximizing the flow in a network and matching the maximum possible number of vertices in a graph. the simplex method is the classic method for solving the general linear programming problem. it works by generating a sequence of adjacent extreme points of the problem's feasible region with improving values of the objective function. the maximum flow problem asks to find the maximum flow possible in a network a weighted directed graph with a source and a sink. the ford fulkerson method is a classic template for solving the maximumflow problem by the iterative improvement approach. the shortestaugmenting path method implements this idea by labeling network vertices in the breadth first search manner. the ford fulkerson method also finds a minimum cut in a given network. a maximum cardinality matching is the largest subset of edges in a graph such that no two edges share the same vertex. for a bipartite graph it can be found by a sequence of augmentations of previously obtained matchings. the stable marriage problem is to find a stable matching for elements of two nelement sets based on given matching preferences. this problem always has a solution that can be found by the gale shapley algorithm. 