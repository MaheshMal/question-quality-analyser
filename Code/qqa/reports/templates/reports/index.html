<!DOCTYPE html>
<html>
	<head>
		<title>Test Sandbox</title>
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://code.highcharts.com/stock/highstock.js"></script>
        <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
        <!--<script src="http://code.highcharts.com/highcharts.js"></script>-->
        {% load static %}
        <script src="{% static "reports/Chart.HeatMap.S.js" %}" ></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">

        <script>
            id = 0;
            questions = [];
            know_labels = ['Factual', 'Conceptual', 'Procedural', 'Metacognitive'];
            cog_labels = ['Remember', 'Understand', 'Apply', 'Analyze', 'Evaluate', 'Create'];

            function classify() {
                subject = $("input[name='subject']:checked").val();
                question = $("#question").val();
                $.post('classify', {'subject':subject, 'question':question}, onsuccess);
            }

            function onsuccess(response) {
                questions.push(response);
                updateUI(response);
            }

            function updateUI(question) {
                qdiv = document.createElement("div");
                qdiv.addEventListener("click", disp, false);
                qdiv.innerHTML = question.question;
                qdiv.id = "q-" + id;
                id += 1;
                $("#questions").append(qdiv);
                heatmap(question.combined);
            }

            function disp(event) {
                qid = event.target.id.split("q-")[1];
                console.log(qid);
            }

            function heatmap(values) {
                var ctx = document.getElementById('heatmap').getContext('2d');
                var newChart = new Chart(ctx).HeatMap(
                        { "labels": cog_labels },
                        { }
                    );
                for(var i = 0; i<4; ++i) {
                    console.log(values[i]);
                    newChart.addDataset(values[i], know_labels[i]);

                }
            }
        </script>
	</head>
	<body>
        <br />
        <div class="container">
            <div class="col-md-2 btn-group" role="group" aria-label="...">
                <span class="input-group-addon">
                    <input type="radio" aria-label="..." name="subject" value="ADA" checked> ADA </input>
                </span>
                <span class="input-group-addon">
                    <input type="radio" aria-label="..." name="subject" value="OS"> OS </input>
                </span>
            </div>
            <div class="col-md-8 input-group">
                <input type="text" class="form-control" placeholder="Enter your question here" aria-describedby="basic-addon1" id="question">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" onclick="classify()">Check</button>
                </span>
            </div>
        </div>

        <div class="container">
            <div class="col-md-6" id="questions">

            </div>
            <div class="col-md-6">
                <canvas id="heatmap" width="600" height="400"></canvas>
            </div>
        </div>
	</body>
</html>
